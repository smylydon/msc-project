"use strict";function processElements(e,t){INPUTS.each(function(t,o){var n=$(o),r={element:n,id:n.attr("id")};cells.push(r),e.filter(function(e){return e.element===r.id}).onValue(function(e){var t=e.formula;console.log("socketUpdate:",e),"="===t.charAt(0)?(r.formula=t,r.value=window.parser(t.substring(1))):(t=isNaN(parseFloat(t))?t:parseFloat(t),r.value=t,r.formula=t),n.val(r.value),localStorage[r.id]=r.formula,console.log("cell is:",r)}),n.asEventStream("focus").onValue(function(e){var t=e.target.id,o=localStorage[t]||"";n.val(o),console.log("focusStream")}),n.asEventStream("blur").map(function(e){var t=e.target.id,o=e.target.value;return localStorage[t]=o,console.log("blurStream"),{element:t,formula:o,user_id:userId}}).onValue(function(e){socket.emit("write",e)})})}for(var _=_,Bacon=Bacon,Cell=function(e){this.id=e.id,this.element=e.element,this.bus=new Bacon.Bus},SpreadSheetFactory=function(){function e(e){this.bus=new Bacon.Bus,this.cells=[],this.addCells(e)}return e.prototype.addCells=function(e){e=_.isArray(e)?e:[],e=e.map(function(e){return new Cell(e)}),Array.prototype.push.apply(this.cells,e)},e.prototype.addCell=function(e){this.cells.push(new Cell(e))},e.prototype.removeCellsById=function(e){e=_.isArray(e)?e:[],_.forEach(e,function(e){_.remove(this.cells,function(t){return t.id===e})})},e.prototype.removeCellById=function(e){_.remove(this.cells,function(t){return t.id===e})},{getSpreadSheet:function(t){return new e(t)}}}(),spreadSheet=SpreadSheetFactory.getSpreadSheet(),i=0;i<6;i++)for(var row=document.querySelector("table").insertRow(-1),j=0;j<6;j++){var letter=String.fromCharCode("A".charCodeAt(0)+j-1);row.insertCell(-1).innerHTML=i&&j?"<input id='"+letter+i+"'/>":i||letter}var DATA={},INPUTS=$("input"),cells=[],userId,socket=io.connect("http://localhost:5000");socket.on("connect",function(e){socket.emit("join","Hello World from client"),socket.on("userid",function(e){userId=e;var t=Bacon.fromBinder(function(e){socket.on("update",function(t){e(t)})}),o=Bacon.fromBinder(function(e){socket.on("messages",function(t){e(t)})});spreadSheet.addCells(cells),processElements(t,o)})});
//# sourceMappingURL=spreadsheet.js.map
