"use strict";window.parser=function(){function e(e){for(var t,r=[],n=/([A-Z]\d+|\d+(\.\d+)?|[+\-\/\*]|\(|\)|(sum|avg|mean)\(\s*[a-z]\d+\s*:\s*[a-z]\d+\s*\))/gi;null!==(t=n.exec(e));)r.push(t[0]);return r}function t(){var e=g[d];return e}function r(){var e=t();return d++,e}function n(e,t){return d++,{token:e,type:t}}function s(){var e={},r=t();if(l.test(r))e=n(r,"unary"),e.right=a();else if(c.test(r))e=n(r,"number");else if(/^\($/.test(r))e=n(r,"leftparen"),e.left=a(),r=t(),")"===r&&(e.right=n(r,"rightparen"));else if(o.test(r))e=n(r,"cellname");else if(f.test(r)){var s="";/sum/gi.test(r)?s="sum":/^(avg|mean)/gi.test(r)&&(s="mean"),e=n(r,s)}else e=n(r,"");return e}function u(){for(var e=s(),n=t();"*"===n||"/"===n;)n=r(),e={token:n,type:"operator",left:e,right:s()},n=t();return e}function a(){for(var e=u(),n=t();"+"===n||"-"===n;)n=r(),e={token:n,type:"operator",left:e,right:u()},n=t();return e}function i(t){return d=0,g=e(t),a()}var f=/(sum|avg|mean)\(\s*[a-z]\d+\s*:\s*[a-z]\d+\s*\)/i,o=/^[A-Z]\d+$/i,l=/[+\-\/\*]/,c=/^\d+(\.\d+)?$/,d=0,g=[];return i}();
//# sourceMappingURL=parser.js.map
