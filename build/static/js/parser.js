"use strict";window.parser=function(){function r(r){for(var e,t=[],n=/([A-Z]\d+|\d+(\.\d+)?|[+\-\/\*]|\(|\)|(sum|avg|mean)\(\s*[a-z]\d+\s*:\s*[a-z]\d+\s*\))/gi;null!==(e=n.exec(r));)t.push(e[0]);return t}function e(){var r=g[d];return r}function t(){var r=e();return d++,r}function n(r,e){return d++,{token:r,type:e}}function a(r,e,t){return r=r.replace(/^\+/,""),r="("+r+")","mean"===e&&(r="("+r+"/"+t+")"),r}function u(r){var e,t="",n="",u="",i="",o=0,s="#ERROR",f=/sum/i.test(r)?"sum":"mean";if(r=r.replace(/(sum|mean|[\(\)]+)/gi,"").replace(" ",""),e=r.split(":"),t=e[0][0],n=e[1][0],t===n){if(u=parseInt(e[0][1]),i=parseInt(e[1][1]),i>=u){for(s="",o=u;u<=i;)s+="+"+t+u,u++,o++;s=a(s,f,o)}}else if(n>=t&&(u=e[0][1],i=e[1][1],i===u)){for(s="";t<=n;)s+="+"+t+u,t++,o++;s=a(s,f,o)}return console.log(">>>",s),s}function i(){var r={},t=e();return p.test(t)?(r=n(t,"unary"),r.right=s()):m.test(t)?r=n(t,"number"):/^\($/.test(t)?(r=n(t,"leftparen"),r.left=s(),t=e(),")"===t&&(r.right=n(t,"rightparen"))):r=l.test(t)?n(t,"cellname"):n(t,""),r}function o(){for(var r=i(),n=e();"*"===n||"/"===n;)n=t(),r={token:n,type:"operator",left:r,right:i()},n=e();return r}function s(){for(var r=o(),n=e();"+"===n||"-"===n;)n=t(),r={token:n,type:"operator",left:r,right:o()},n=e();return r}function f(e){return d=0,e=e.replace(c,u),g=r(e),s()}var c=/(sum|avg|mean)\(\s*[a-z]\d+\s*:\s*[a-z]\d+\s*\)/gi,l=/^[A-Z]\d+$/i,p=/[+\-\/\*]/,m=/^\d+(\.\d+)?$/,d=0,g=[];return f}();
//# sourceMappingURL=parser.js.map
