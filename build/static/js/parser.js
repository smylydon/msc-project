"use strict";window.parser=function(){function e(e){for(var r,t=[],n=/([A-Z]([1-9]\d+|[1-9])|\d+(\.\d+)?|[+\-\/\*]|\(|\))/gi;null!==(r=n.exec(e));)t.push(r[0]);return t}function r(){return C[A]}function t(){var e=r();return A++,e}function n(e,r){return A++,{token:e,type:r}}function u(){var e={},t=r();return h.test(t)?(e=n(t,"unary"),e.right=o()):y.test(t)?e=n(t,"number"):/^\($/.test(t)?(e=n(t,"leftparen"),e.left=o(),t=r(),")"===t&&(e.right=n(t,"rightparen"))):e=m.test(t)?n(t,"cellname"):n(t,""),e}function a(){for(var e=u(),n=r();"*"===n||"/"===n;)n=t(),e={token:n,type:"operator",left:e,right:u()},n=r();return e}function o(){for(var e=a(),n=r();"+"===n||"-"===n;)n=t(),e={token:n,type:"operator",left:e,right:a()},n=r();return e}function i(e){return String.fromCharCode(e.charCodeAt(0)+1)}function f(e,r,t){return e=e.replace(/^\+/,""),e="("+e+")","mean"===r&&(e="("+e+"/"+t+")"),e}function c(e){var r,t="",n="",u="",a="",o=0,c="#ERROR",s=/sum/i.test(e)?"sum":"mean";if(e=e.replace(/(sum|avg|mean|[\(\)]+)/gi,"").replace(" ",""),r=e.split(":"),t=r[0][0],n=r[1][0],u=parseInt(r[0][1]),a=parseInt(r[1][1]),t===n){if(a>=u){for(c="";u<=a;)c+="+"+t+u,u++,o++;c=f(c,s,o)}}else if(n>=t&&a===u){for(c="";t<=n;)c+="+"+t+u,t=i(t),o++;c=f(c,s,o)}return console.log(">>>",c),c}function s(e){d=e}function l(e){var r=d.getCellById(e),t=r.formula;return v.test(t)&&(e=t.replace(v,l)),e}function p(r){return r=r||"",A=0,r=r.replace(g,c),r=r.replace(v,l),C=e(r),o()}var d,g=/(sum|avg|mean)\(\s*[a-z]([1-9]\d+|[1-9])\s*:\s*[a-z]([1-9]\d+|[1-9])\s*\)/gi,m=/^[A-Z]([1-9]\d+|[1-9])$/i,v=/[A-Z]([1-9]\d+|[1-9])/gi,h=/[+\-\/\*]/,y=/^\d+(\.\d+)?$/,A=0,C=[];return{parse:p,setSpreadSheet:s}}();
//# sourceMappingURL=parser.js.map
