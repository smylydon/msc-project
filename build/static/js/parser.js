"use strict";window.parser=function(){function r(r){for(var t,e=[],n=/([A-Z]([1-9]\d+|[1-9])|\d+(\.\d+)?|[+\-\/\*]|\(|\))/gi;null!==(t=n.exec(r));)e.push(t[0]);return e}function t(){var r=v[m];return r}function e(){var r=t();return m++,r}function n(r,t){return m++,{token:r,type:t}}function u(r){return String.fromCharCode(r.charCodeAt(0)+1)}function a(r,t,e){return r=r.replace(/^\+/,""),r="("+r+")","mean"===t&&(r="("+r+"/"+e+")"),r}function o(r){var t,e="",n="",o="",i="",f=0,s="#ERROR",c=/sum/i.test(r)?"sum":"mean";if(r=r.replace(/(sum|avg|mean|[\(\)]+)/gi,"").replace(" ",""),t=r.split(":"),e=t[0][0],n=t[1][0],o=parseInt(t[0][1]),i=parseInt(t[1][1]),e===n){if(i>=o){for(s="";o<=i;)s+="+"+e+o,o++,f++;s=a(s,c,f)}}else if(n>=e&&i===o){for(s="";e<=n;)s+="+"+e+o,e=u(e),f++;s=a(s,c,f)}return console.log(">>>",s),s}function i(){var r={},e=t();return g.test(e)?(r=n(e,"unary"),r.right=s()):d.test(e)?r=n(e,"number"):/^\($/.test(e)?(r=n(e,"leftparen"),r.left=s(),e=t(),")"===e&&(r.right=n(e,"rightparen"))):r=p.test(e)?n(e,"cellname"):n(e,""),r}function f(){for(var r=i(),n=t();"*"===n||"/"===n;)n=e(),r={token:n,type:"operator",left:r,right:i()},n=t();return r}function s(){for(var r=f(),n=t();"+"===n||"-"===n;)n=e(),r={token:n,type:"operator",left:r,right:f()},n=t();return r}function c(t){return m=0,t=t.replace(l,o),v=r(t),s()}var l=/(sum|avg|mean)\(\s*[a-z]([1-9]\d+|[1-9])\s*:\s*[a-z]([1-9]\d+|[1-9])\s*\)/gi,p=/^[A-Z]([1-9]\d+|[1-9])$/i,g=/[+\-\/\*]/,d=/^\d+(\.\d+)?$/,m=0,v=[];return c}();
//# sourceMappingURL=parser.js.map
